<!DOCTYPE html>
<html>
<head>
<title>Spectrum ROM: Routine at 02819</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Spectrum ROM" src="../../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="2780.html">02780</a></span></td>
<td class="up">Up: <a href="../maps/all.html#2819">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="2852.html">02852</a></span></td>
</tr>
</table>
<div class="description">02819: THE 'POSITION FETCH' SUBROUTINE</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="2548.html">PRINT_OUT</a>, <a href="2655.html">PO_COMMA</a>, <a href="2669.html">PO_TV_2</a> and <a href="2852.html">PO_ANY</a>.
</div>
<div class="paragraph">
The current position's parameters are fetched from the appropriate system variables.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-1">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>
<tr>
<td class="register">B</td>
<td class="register-desc">Line number</td>
</tr>
<tr>
<td class="register">C</td>
<td class="register-desc">Column number</td>
</tr>
<tr>
<td class="register">HL</td>
<td class="register-desc">Display file address or printer buffer address</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="asm-label-1">PO_FETCH</td>
<td class="address-2"><span id="2819"></span>02819</td>
<td class="bytes-0"></td>
<td class="instruction">BIT 1,(IY+1)</td>
<td class="comment-11" rowspan="2">Jump forward if handling the printer (bit 1 of <a href="23611.html">FLAGS</a> set).</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2823"></span>02823</td>
<td class="bytes-0"></td>
<td class="instruction">JR NZ,<a href="2819.html#2845">PO_F_PR</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2825"></span>02825</td>
<td class="bytes-0"></td>
<td class="instruction">LD BC,(23688)</td>
<td class="comment-11" rowspan="4">Fetch the values relating to the main part of the screen from <a href="23688.html">S-POSN</a> and <a href="23684.html">DF-CC</a> and return if this was the intention (bit 0 of <a href="23612.html">TV-FLAG</a> set).</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2829"></span>02829</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,(23684)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2832"></span>02832</td>
<td class="bytes-0"></td>
<td class="instruction">BIT 0,(IY+2)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2836"></span>02836</td>
<td class="bytes-0"></td>
<td class="instruction">RET Z</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2837"></span>02837</td>
<td class="bytes-0"></td>
<td class="instruction">LD BC,(23690)</td>
<td class="comment-11" rowspan="2">Otherwise fetch the values relating to the lower part of the screen from <a href="23690.html">S-POSNL</a> and <a href="23686.html">DF-CCL</a>.</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2841"></span>02841</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,(23686)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2844"></span>02844</td>
<td class="bytes-0"></td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1">PO_F_PR</td>
<td class="address-2"><span id="2845"></span>02845</td>
<td class="bytes-0"></td>
<td class="instruction">LD C,(IY+69)</td>
<td class="comment-11" rowspan="2">Fetch the values relating to the printer buffer from <a href="23679.html">P-POSN</a> and <a href="23680.html">PR-CC</a>.</td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2848"></span>02848</td>
<td class="bytes-0"></td>
<td class="instruction">LD HL,(23680)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-1"></td>
<td class="address-1"><span id="2851"></span>02851</td>
<td class="bytes-0"></td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="2780.html">02780</a></span></td>
<td class="up">Up: <a href="../maps/all.html#2819">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="2852.html">02852</a></span></td>
</tr>
</table>
<footer>
<div class="release">The Complete Spectrum ROM Disassembly 20190603</div>
<div class="copyright">&#169; 1982 Amstrad. &#169; 1983 Dr Ian Logan &amp; Dr Frank O'Hara. &#169; 2019 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 7.2.</div>
<div><a href="../../asm/0B03.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>