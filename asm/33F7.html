<!DOCTYPE html>
<html>
<head>
<title>Spectrum ROM: Routine at 33F7</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Spectrum ROM" src="../images/logo-hex.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="33C6.html">33C6</a>
</td>
<td class="up">Up: <a href="../maps/all.html#33F7">Map</a></td>
<td class="next">
Next: <a href="3406.html">3406</a>
</td>
</tr>
</table>
<div class="description">33F7: THE 'SKIP CONSTANTS' SUBROUTINE</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="341B.html">stk_con</a>.
</div>
<div class="paragraph">
This subroutine is entered with the <span class="register">HL'</span> register pair holding the base address of the calculator's <a href="32C5.html">table of constants</a> and the <span class="register">A</span> register holding a parameter that shows which of the five constants is being requested.
</div>
<div class="paragraph">
The subroutine performs the null operations of loading the five bytes of each unwanted constant into the locations 0000, 0001, 0002, 0003 and 0004 at the beginning of the ROM until the requested constant is reached.
</div>
<div class="paragraph">
The subroutine returns with the <span class="register">HL'</span> register pair holding the base address of the requested constant within the table of constants.
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">Index of the required constant (+00 to +04)</td>
</tr>
<tr>
<td class="register">HL'</td>
<td class="register-desc"><a href="32C5.html">CONSTANTS</a></td>
</tr>
</table>
<table class="output">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>
<tr>
<td class="register">HL'</td>
<td class="register-desc">Address of the required constant</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="asm-label">SKIP_CONS</td>
<td class="address-2"><span id="33F7"></span>33F7</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="2">The subroutine returns if the parameter is zero, or when the requested constant has been reached.</td>
</tr>
<tr>
<td class="asm-label">SKIP_NEXT</td>
<td class="address-2"><span id="33F8"></span>33F8</td>
<td class="instruction">RET Z</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="33F9"></span>33F9</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">Save the parameter.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="33FA"></span>33FA</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1">Save the result pointer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="33FB"></span>33FB</td>
<td class="instruction">LD DE,$0000</td>
<td class="comment-1" rowspan="1">The dummy address.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="33FE"></span>33FE</td>
<td class="instruction">CALL <a href="33C6.html#33C8">STK_CONST</a></td>
<td class="comment-1" rowspan="1">Perform imaginary stacking of an expanded constant.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="3401"></span>3401</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1">Restore the result pointer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="3402"></span>3402</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore the parameter.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="3403"></span>3403</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">Count the loops.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="3404"></span>3404</td>
<td class="instruction">JR <a href="33F7.html#33F8">SKIP_NEXT</a></td>
<td class="comment-1" rowspan="1">Jump back to consider the value of the counter.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="33C6.html">33C6</a>
</td>
<td class="up">Up: <a href="../maps/all.html#33F7">Map</a></td>
<td class="next">
Next: <a href="3406.html">3406</a>
</td>
</tr>
</table>
<footer>
<div class="release">The Complete Spectrum ROM Disassembly 20200807</div>
<div class="copyright">&#169; 1982 Amstrad. &#169; 1983 Dr Ian Logan &amp; Dr Frank O'Hara. &#169; 2020 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.2.</div>
<div><a href="../dec/asm/13303.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>