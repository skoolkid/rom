<!DOCTYPE html>
<html>
<head>
<title>Spectrum ROM: Routine at 1DDA</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Spectrum ROM" src="../images/logo-hex.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="1DAB.html">1DAB</a>
</td>
<td class="up">Up: <a href="../maps/all.html#1DDA">Map</a></td>
<td class="next">
Next: <a href="1DEC.html">1DEC</a>
</td>
</tr>
</table>
<div class="description">1DDA: THE 'NEXT-LOOP' SUBROUTINE</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="1D03.html">FOR</a> and <a href="1DAB.html">NEXT</a>.
</div>
<div class="paragraph">
This subroutine is used to determine whether the LIMIT (l) has been exceeded by the present VALUE (v). Note has to be taken of the sign of the STEP (s).
</div>
<div class="paragraph">
The subroutine returns the carry flag set if the LIMIT is exceeded.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">NEXT_LOOP</td>
<td class="address-2"><span id="1DDA"></span>1DDA</td>
<td class="instruction">RST <a href="0028.html">$28</a></td>
<td class="comment-1" rowspan="1">-</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DDB"></span>1DDB</td>
<td class="instruction">DEFB $E1</td>
<td class="comment-1" rowspan="1"><a href="340F.html">get_mem_1</a>: l</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DDC"></span>1DDC</td>
<td class="instruction">DEFB $E0</td>
<td class="comment-1" rowspan="1"><a href="340F.html">get_mem_0</a>: l, v</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DDD"></span>1DDD</td>
<td class="instruction">DEFB $E2</td>
<td class="comment-1" rowspan="1"><a href="340F.html">get_mem_2</a>: l, v, s</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DDE"></span>1DDE</td>
<td class="instruction">DEFB $36</td>
<td class="comment-1" rowspan="1"><a href="3506.html">less_0</a>: l, v,( 1/0)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DDF"></span>1DDF</td>
<td class="instruction">DEFB $00</td>
<td class="comment-1" rowspan="2"><a href="368F.html">jump_true</a> to <a href="1DDA.html#1DE2">NEXT_1</a>: l, v, (1/0)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DE0"></span>1DE0</td>
<td class="instruction">DEFB $02</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DE1"></span>1DE1</td>
<td class="instruction">DEFB $01</td>
<td class="comment-1" rowspan="1"><a href="343C.html">exchange</a>: v, l</td>
</tr>
<tr>
<td class="asm-label">NEXT_1</td>
<td class="address-1"><span id="1DE2"></span>1DE2</td>
<td class="instruction">DEFB $03</td>
<td class="comment-1" rowspan="1"><a href="300F.html">subtract</a>: v-l or l-v</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DE3"></span>1DE3</td>
<td class="instruction">DEFB $37</td>
<td class="comment-1" rowspan="1"><a href="34F9.html">greater_0</a>: (1/0)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DE4"></span>1DE4</td>
<td class="instruction">DEFB $00</td>
<td class="comment-1" rowspan="2"><a href="368F.html">jump_true</a> to <a href="1DDA.html#1DE9">NEXT_2</a>: (1/0)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DE5"></span>1DE5</td>
<td class="instruction">DEFB $04</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DE6"></span>1DE6</td>
<td class="instruction">DEFB $38</td>
<td class="comment-1" rowspan="1"><a href="369B.html">end_calc</a>: -</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DE7"></span>1DE7</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="2">Clear the carry flag and return - loop is possible.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DE8"></span>1DE8</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="1DE9"></span>
<div class="comments">
<div class="paragraph">
However if the loop is impossible the carry flag has to be set.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">NEXT_2</td>
<td class="address-1"><span id="1DE9"></span>1DE9</td>
<td class="instruction">DEFB $38</td>
<td class="comment-1" rowspan="1"><a href="369B.html">end_calc</a>: -</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DEA"></span>1DEA</td>
<td class="instruction">SCF</td>
<td class="comment-1" rowspan="2">Set the carry flag and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="1DEB"></span>1DEB</td>
<td class="instruction">RET</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="1DAB.html">1DAB</a>
</td>
<td class="up">Up: <a href="../maps/all.html#1DDA">Map</a></td>
<td class="next">
Next: <a href="1DEC.html">1DEC</a>
</td>
</tr>
</table>
<footer>
<div class="release">The Complete Spectrum ROM Disassembly 20221121</div>
<div class="copyright">&#169; 1982 Amstrad. &#169; 1983 Dr Ian Logan &amp; Dr Frank O'Hara. &#169; 2022 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.8.</div>
<div><a href="../dec/asm/7642.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>