<!DOCTYPE html>
<html>
<head>
<title>Spectrum ROM: Routine at 2F8B</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Spectrum ROM" src="../images/logo-hex.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="2DE3.html">2DE3</a>
</td>
<td class="up">Up: <a href="../maps/all.html#2F8B">Map</a></td>
<td class="next">
Next: <a href="2F9B.html">2F9B</a>
</td>
</tr>
</table>
<div class="description">2F8B: THE 'CA=10*A+C' SUBROUTINE</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
This subroutine is called by <a href="2DE3.html">PRINT_FP</a> to multiply each byte of <span class="register">D'E'DE</span> by 10 and return the integer part of the result in the <span class="register">C</span> register. On entry, the <span class="register">A</span> register contains the byte to be multiplied by 10 and the <span class="register">C</span> register contains the carry over from the previous byte. On return, the <span class="register">A</span> register contains the resulting byte and the <span class="register">C</span> register the carry forward to the next byte.
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">First number (M)</td>
</tr>
<tr>
<td class="register">C</td>
<td class="register-desc">Second number (N)</td>
</tr>
</table>
<table class="output">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">LSB of 10*M+N</td>
</tr>
<tr>
<td class="register">C</td>
<td class="register-desc">MSB of 10*M+N</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="asm-label">CA_10A_C</td>
<td class="address-2"><span id="2F8B"></span>2F8B</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1">Save whichever <span class="register">DE</span> pair is in use.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F8C"></span>2F8C</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="2">Copy the multiplicand from <span class="register">A</span> to <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F8D"></span>2F8D</td>
<td class="instruction">LD H,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F8F"></span>2F8F</td>
<td class="instruction">LD E,L</td>
<td class="comment-1" rowspan="2">Copy it to <span class="register">DE</span> too.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F90"></span>2F90</td>
<td class="instruction">LD D,H</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F91"></span>2F91</td>
<td class="instruction">ADD HL,HL</td>
<td class="comment-1" rowspan="1">Double <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F92"></span>2F92</td>
<td class="instruction">ADD HL,HL</td>
<td class="comment-1" rowspan="1">Double it again.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F93"></span>2F93</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1">Add in <span class="register">DE</span> to give <span class="register">HL</span>=5*<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F94"></span>2F94</td>
<td class="instruction">ADD HL,HL</td>
<td class="comment-1" rowspan="1">Double again: now <span class="register">HL</span>=10*<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F95"></span>2F95</td>
<td class="instruction">LD E,C</td>
<td class="comment-1" rowspan="1">Copy <span class="register">C</span> to <span class="register">DE</span> (<span class="register">D</span> is zero) for addition.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F96"></span>2F96</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1">Now <span class="register">HL</span>=10*<span class="register">A</span>+<span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F97"></span>2F97</td>
<td class="instruction">LD C,H</td>
<td class="comment-1" rowspan="1"><span class="register">H</span> is copied to <span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F98"></span>2F98</td>
<td class="instruction">LD A,L</td>
<td class="comment-1" rowspan="1"><span class="register">L</span> is copied to <span class="register">A</span>, completing the task.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F99"></span>2F99</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1">The <span class="register">DE</span> register pair is restored.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="2F9A"></span>2F9A</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Finished.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="2DE3.html">2DE3</a>
</td>
<td class="up">Up: <a href="../maps/all.html#2F8B">Map</a></td>
<td class="next">
Next: <a href="2F9B.html">2F9B</a>
</td>
</tr>
</table>
<footer>
<div class="release">The Complete Spectrum ROM Disassembly 20200807</div>
<div class="copyright">&#169; 1982 Amstrad. &#169; 1983 Dr Ian Logan &amp; Dr Frank O'Hara. &#169; 2020 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.2.</div>
<div><a href="../dec/asm/12171.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>